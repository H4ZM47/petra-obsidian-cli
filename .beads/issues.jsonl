{"id":"petra-0n3","title":"Phase 1: Foundation (MVP)","description":"Monorepo setup, CLI scaffolding, file-mode CRUD for notes, vault discovery, config system, output modes.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-08T12:19:51.675494-06:00","updated_at":"2025-12-08T12:37:15.767213-06:00","closed_at":"2025-12-08T12:37:15.767213-06:00"}
{"id":"petra-0qc","title":"Implement note create command","description":"Create markdown files in vault, support frontmatter, handle path normalization.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.209566-06:00","updated_at":"2025-12-08T12:37:04.521891-06:00","closed_at":"2025-12-08T12:37:04.521891-06:00","dependencies":[{"issue_id":"petra-0qc","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.403857-06:00","created_by":"daemon"},{"issue_id":"petra-0qc","depends_on_id":"petra-jad","type":"blocks","created_at":"2025-12-08T12:20:30.887583-06:00","created_by":"daemon"}]}
{"id":"petra-13w","title":"Set up Bun monorepo with workspaces","description":"Initialize Bun project, configure workspaces for cli, plugin, and shared packages. Set up TypeScript config.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:07.670097-06:00","updated_at":"2025-12-08T12:29:17.061866-06:00","closed_at":"2025-12-08T12:29:17.061866-06:00","dependencies":[{"issue_id":"petra-13w","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.026493-06:00","created_by":"daemon"}]}
{"id":"petra-1i0","title":"Implement daily notes endpoints","description":"Add: POST /daily (create today's note), GET /daily/:date (read daily note). Integrate with Obsidian's daily notes plugin settings. Use configured template if available.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:05.298006-06:00","updated_at":"2025-12-08T13:04:44.371982-06:00","closed_at":"2025-12-08T13:04:44.371982-06:00","dependencies":[{"issue_id":"petra-1i0","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:05.298623-06:00","created_by":"daemon"}]}
{"id":"petra-1jx","title":"LOW: Use stricter typing for frontmatter","description":"Overly permissive frontmatter type in `packages/shared/src/types.ts:10`. `[key: string]: unknown` allows any property.","design":"Consider stricter typing for common fields (title, tags, date, aliases) while still allowing custom properties.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.762884-06:00","updated_at":"2025-12-08T14:11:33.762884-06:00","labels":["code-quality","code-review","low"]}
{"id":"petra-1sb","title":"Add graph CLI commands","description":"Add `petra graph neighbors \u003cpath\u003e` (nodes connected to a note) and `petra graph query` (advanced graph traversal). Options: --depth, --direction (in/out/both), --filter. Require bridge mode.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.414379-06:00","updated_at":"2025-12-08T13:12:07.765501-06:00","closed_at":"2025-12-08T13:12:07.765501-06:00","dependencies":[{"issue_id":"petra-1sb","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.415166-06:00","created_by":"daemon"}]}
{"id":"petra-1wt","title":"HIGH: Escape user input before regex construction","description":"Unescaped regex from user input in `packages/cli/src/commands/note.ts:172-180`. `new RegExp(query)` without escaping. Special regex chars in query cause errors or unintended matching.","design":"Escape special regex characters:\n```typescript\nfunction escapeRegex(str: string): string {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$\u0026');\n}\nconst highlightedText = match.text.replace(\n  new RegExp(`(${escapeRegex(query)})`, options.caseSensitive ? 'g' : 'gi'),\n  chalk.inverse('$1')\n);\n```","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:10:39.846872-06:00","updated_at":"2025-12-08T14:10:39.846872-06:00","labels":["code-review","high","stability"]}
{"id":"petra-4rn","title":"MEDIUM: Fix regex injection in backlinks search","description":"Regex injection in `packages/plugin/src/routes/links.ts:90-94`. Constructs regex with unescaped targetBasename. Special chars in filenames cause regex errors or unexpected matches.","design":"Escape special regex characters in filename before constructing the link matching pattern.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:11:04.733828-06:00","updated_at":"2025-12-08T14:11:04.733828-06:00","labels":["code-review","medium","stability"]}
{"id":"petra-50e","title":"LOW: Make graph node limit configurable","description":"Magic number 100 for graph size in `packages/plugin/src/routes/graph.ts:137`. Hardcoded limit of 100 nodes for full graph. Should be configurable or documented.","design":"Add configurable limit via query parameter or config file. Document default behavior.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.636263-06:00","updated_at":"2025-12-08T14:11:33.636263-06:00","labels":["code-review","low","ux"]}
{"id":"petra-5ot","title":"LOW: Make template folder names configurable","description":"Hardcoded template folder names in `packages/plugin/src/routes/templates.ts:15-24`. possibleFolders array should be configurable or read from Obsidian settings.","design":"Read template folder from Obsidian core templates plugin settings, or allow configuration via Petra settings.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.828898-06:00","updated_at":"2025-12-08T14:11:33.828898-06:00","labels":["code-review","low","ux"]}
{"id":"petra-5s2","title":"MEDIUM: Log warning on config parse error instead of silent failure","description":"Silent failure on config parse error in `packages/cli/src/lib/config.ts:27-32`. loadConfig() returns {} on JSON parse error without any indication to user.","design":"Log a warning message when config file exists but can't be parsed. Could indicate corrupted config file that user should fix.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:11:04.617018-06:00","updated_at":"2025-12-08T14:11:04.617018-06:00","labels":["code-review","medium","ux"]}
{"id":"petra-5ut","title":"Implement link-aware note move","description":"Enhance POST /notes/:path/move to update all backlinks when moving a note. Use Obsidian's app.fileManager.renameFile() which handles link rewrites. CLI uses bridge when available for safe moves.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.787669-06:00","updated_at":"2025-12-08T13:12:08.088082-06:00","closed_at":"2025-12-08T13:12:08.088082-06:00","dependencies":[{"issue_id":"petra-5ut","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.788275-06:00","created_by":"daemon"}]}
{"id":"petra-5ze","title":"Add CLI bridge auto-detection","description":"Create packages/cli/src/lib/bridge.ts with: checkBridgeAvailable() pings /health, getBridgeClient() returns configured fetch wrapper. Commands try bridge first, fall back to file mode, or error if bridge required.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:05.069041-06:00","updated_at":"2025-12-08T12:54:07.093061-06:00","closed_at":"2025-12-08T12:54:07.093061-06:00","dependencies":[{"issue_id":"petra-5ze","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:05.070241-06:00","created_by":"daemon"}]}
{"id":"petra-691","title":"HIGH: Fix timing attack vulnerability in auth check","description":"Timing attack vulnerability in `packages/plugin/src/server.ts:140-147`. String comparison with === allows timing attacks on token validation.","design":"Use constant-time comparison:\n```typescript\nimport { timingSafeEqual } from \"crypto\";\nconst expectedBuf = Buffer.from(this.authToken);\nconst actualBuf = Buffer.from(token);\nif (expectedBuf.length !== actualBuf.length) return false;\nreturn timingSafeEqual(expectedBuf, actualBuf);\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T14:10:26.550815-06:00","updated_at":"2025-12-08T15:16:21.194233-06:00","closed_at":"2025-12-08T15:16:21.194233-06:00","labels":["code-review","high","security"]}
{"id":"petra-72w","title":"HIGH: Add request body size limit to prevent DoS","description":"No request body size limit in `packages/plugin/src/server.ts:149-166`. parseBody() has no size limit which can cause DoS via memory exhaustion.","design":"Add 10MB limit:\n```typescript\nconst MAX_BODY_SIZE = 10 * 1024 * 1024;\nreq.on('data', (chunk) =\u003e {\n  size += chunk.length;\n  if (size \u003e MAX_BODY_SIZE) {\n    reject(new Error('Request body too large'));\n    req.destroy();\n    return;\n  }\n  chunks.push(chunk);\n});\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T14:10:26.578691-06:00","updated_at":"2025-12-08T15:16:21.268152-06:00","closed_at":"2025-12-08T15:16:21.268152-06:00","labels":["code-review","high","security"]}
{"id":"petra-7ii","title":"Scaffold Obsidian plugin structure","description":"Set up packages/plugin with proper Obsidian plugin structure: manifest.json, styles.css placeholder, main.ts entry point extending Plugin class. Configure build to output main.js for Obsidian.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:04.596781-06:00","updated_at":"2025-12-08T12:54:06.991333-06:00","closed_at":"2025-12-08T12:54:06.991333-06:00","dependencies":[{"issue_id":"petra-7ii","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:04.597828-06:00","created_by":"daemon"}]}
{"id":"petra-7pz","title":"Add template CLI commands","description":"Add `petra template list` (show available templates) and `petra template run \u003cname\u003e \u003cdestination\u003e` (create note from template). Options: --var key=value for template variables. Require bridge mode.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.665304-06:00","updated_at":"2025-12-08T13:12:07.976248-06:00","closed_at":"2025-12-08T13:12:07.976248-06:00","dependencies":[{"issue_id":"petra-7pz","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.665919-06:00","created_by":"daemon"}]}
{"id":"petra-7xs","title":"HIGH: Optimize O(nÂ²) backlinks algorithm","description":"Performance issue in `packages/plugin/src/routes/graph.ts:114-128`. Scans all files for every file in graph query. Could hang on large vaults (1000+ notes).","design":"Options:\n1. Build and cache an inverted index of links\n2. Limit query scope with pagination\n3. Use background indexing on vault open\n4. Add timeout/cancellation for long queries","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:10:26.653732-06:00","updated_at":"2025-12-08T14:10:26.653732-06:00","labels":["code-review","high","performance"]}
{"id":"petra-863","title":"LOW: Optimize date sorting with Date parsing","description":"Sort uses string comparison on dates in `packages/cli/src/lib/notes.ts:206-210`. localeCompare on ISO dates works but is inefficient.","design":"Parse to Date and compare numerically for better performance, especially with large result sets.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.442344-06:00","updated_at":"2025-12-08T14:11:33.442344-06:00","labels":["code-review","low","performance"]}
{"id":"petra-93k","title":"Implement token-based authentication","description":"Generate random auth token on first plugin run. Store token at ~/.petra/token. CLI reads token and sends as Authorization: Bearer header. /health endpoint exempt from auth. Return 401 for invalid/missing tokens.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:04.837099-06:00","updated_at":"2025-12-08T13:01:05.026552-06:00","closed_at":"2025-12-08T13:01:05.026552-06:00","dependencies":[{"issue_id":"petra-93k","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:04.83848-06:00","created_by":"daemon"},{"issue_id":"petra-93k","depends_on_id":"petra-ix1","type":"blocks","created_at":"2025-12-08T12:49:46.808089-06:00","created_by":"daemon"}]}
{"id":"petra-98p","title":"Implement output formatting","description":"Pretty print by default, JSON with --json flag, quiet mode with -q, respect config preferences.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.760538-06:00","updated_at":"2025-12-08T12:37:15.740303-06:00","closed_at":"2025-12-08T12:37:15.740303-06:00","dependencies":[{"issue_id":"petra-98p","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.793326-06:00","created_by":"daemon"},{"issue_id":"petra-98p","depends_on_id":"petra-d30","type":"blocks","created_at":"2025-12-08T12:20:31.279194-06:00","created_by":"daemon"}]}
{"id":"petra-99y","title":"MEDIUM: Convert require() to import in config command","description":"Using require() in ES module in `packages/cli/src/commands/config.ts:55-57`. Should use import for consistency with rest of codebase.","design":"Replace:\n```typescript\nconst { homedir } = require(\"node:os\");\nconst { join } = require(\"node:path\");\n```\nWith imports at top of file.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:04.788629-06:00","updated_at":"2025-12-08T14:11:04.788629-06:00","labels":["code-quality","code-review","medium"]}
{"id":"petra-abx","title":"Implement tag search command","description":"Add `petra tag search \u003ctag\u003e` to find notes with a specific tag. Support partial matching and multiple tags with --all or --any flags.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:42:27.087089-06:00","updated_at":"2025-12-08T12:46:52.072114-06:00","closed_at":"2025-12-08T12:46:52.072114-06:00","dependencies":[{"issue_id":"petra-abx","depends_on_id":"petra-r7u","type":"blocks","created_at":"2025-12-08T12:42:27.087767-06:00","created_by":"daemon"}]}
{"id":"petra-ayr","title":"Add structured logging framework","description":"Currently using console.log throughout. Need structured logging for better observability and debugging.","design":"Options:\n- pino (recommended for performance)\n- winston (feature-rich)\n\nFeatures needed:\n- Log levels (debug, info, warn, error)\n- JSON output for machine parsing\n- Context/correlation IDs for request tracing\n- Configurable via environment or config file","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-08T14:11:55.754116-06:00","updated_at":"2025-12-08T14:11:55.754116-06:00","labels":["code-quality","code-review","observability"]}
{"id":"petra-azm","title":"Phase 3: Plugin Bridge","description":"Build the Obsidian plugin (petra-bridge) with HTTP server, token auth, and bridge-mode endpoints. Enable CLI auto-detection of bridge availability.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-08T12:48:44.857593-06:00","updated_at":"2025-12-08T13:04:44.474829-06:00","closed_at":"2025-12-08T13:04:44.474829-06:00"}
{"id":"petra-b4j","title":"HIGH: Restrict CORS to localhost only","description":"CORS set to wildcard \"*\" in `packages/plugin/src/server.ts:58`. Allows any origin to access the API which is a security risk.","design":"Restrict to localhost:\n```typescript\nres.setHeader(\"Access-Control-Allow-Origin\", \"http://127.0.0.1\");\n// Or enumerate allowed localhost ports if needed\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T14:10:26.604088-06:00","updated_at":"2025-12-08T15:16:21.347286-06:00","closed_at":"2025-12-08T15:16:21.347286-06:00","labels":["code-review","high","security"]}
{"id":"petra-bmp","title":"MEDIUM: Add file size limit to search operations","description":"Search performance issue in `packages/plugin/src/routes/search.ts:54-92`. Reads entire content of every file. Large files could cause memory issues or slow searches.","design":"Add configurable max file size limit (e.g., 1MB). Skip or truncate files larger than limit. Consider streaming for large files.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:11:04.675051-06:00","updated_at":"2025-12-08T14:11:04.675051-06:00","labels":["code-review","medium","performance"]}
{"id":"petra-bn4","title":"Implement template endpoints","description":"Add GET /templates (list available templates from Templates folder), POST /templates/:name/run (execute template with variables). Support both core templates and Templater plugin if available.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.542062-06:00","updated_at":"2025-12-08T13:12:07.870065-06:00","closed_at":"2025-12-08T13:12:07.870065-06:00","dependencies":[{"issue_id":"petra-bn4","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.54268-06:00","created_by":"daemon"}]}
{"id":"petra-d30","title":"Scaffold CLI with commander","description":"Set up CLI entry point, commander configuration, global flags (--json, --quiet, --vault), and command structure.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:07.885671-06:00","updated_at":"2025-12-08T12:33:18.897895-06:00","closed_at":"2025-12-08T12:33:18.897895-06:00","dependencies":[{"issue_id":"petra-d30","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.178181-06:00","created_by":"daemon"},{"issue_id":"petra-d30","depends_on_id":"petra-vjs","type":"blocks","created_at":"2025-12-08T12:20:30.651093-06:00","created_by":"daemon"}]}
{"id":"petra-dae","title":"Implement backlinks endpoint","description":"Add GET /notes/:path/backlinks endpoint. Use Obsidian's MetadataCache.getBacklinksForFile() to get notes linking to the target. Return array of NoteInfo with link context snippets.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:25.915319-06:00","updated_at":"2025-12-08T13:12:07.34332-06:00","closed_at":"2025-12-08T13:12:07.34332-06:00","dependencies":[{"issue_id":"petra-dae","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:25.91603-06:00","created_by":"daemon"}]}
{"id":"petra-dgq","title":"MEDIUM: Fix ReDoS potential in tag extraction regex","description":"ReDoS potential in `packages/cli/src/lib/tags.ts:28-34`. extractInlineTags() uses multiple regex passes. Malicious content with nested patterns could cause ReDoS (Regular Expression Denial of Service).","design":"Use safer regex patterns with bounded quantifiers. Consider using a single-pass approach or limiting content length before regex processing.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:11:04.703502-06:00","updated_at":"2025-12-08T14:11:04.703502-06:00","labels":["code-review","medium","security"]}
{"id":"petra-e1o","title":"CRITICAL: Fix path traversal vulnerability in CLI notes.ts","description":"Path traversal vulnerability in `packages/cli/src/lib/notes.ts:29-32`. User input (notePath) is not sanitized before join(). An attacker could use \"../../../etc/passwd\" to access files outside vault.","design":"Add path sanitization:\n```typescript\nfunction safePath(notePath: string, vaultRoot: string): string {\n  const normalized = path.normalize(notePath).replace(/^(\\.\\.[\\/\\\\])+/, '');\n  const full = path.join(vaultRoot, normalized);\n  if (!full.startsWith(vaultRoot)) {\n    throw new PetraError('INVALID_PATH', 'Path escapes vault');\n  }\n  return full;\n}\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T14:10:07.357537-06:00","updated_at":"2025-12-08T15:14:07.369223-06:00","closed_at":"2025-12-08T15:14:07.369223-06:00","labels":["code-review","critical","security"]}
{"id":"petra-e7g","title":"CRITICAL: Replace weak token generation with crypto.randomBytes","description":"Token generation in `packages/plugin/src/auth.ts:11-17` uses Math.random() which is cryptographically insecure. Tokens are predictable and can be brute-forced.","design":"Replace with Node's crypto module:\n```typescript\nimport { randomBytes } from \"crypto\";\nfunction generateToken(): string {\n  return randomBytes(32).toString('base64url');\n}\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T14:10:07.331783-06:00","updated_at":"2025-12-08T15:14:07.289211-06:00","closed_at":"2025-12-08T15:14:07.289211-06:00","labels":["code-review","critical","security"]}
{"id":"petra-edq","title":"Implement outlinks endpoint","description":"Add GET /notes/:path/outlinks endpoint. Parse note content for [[wikilinks]] and [markdown](links). Return array of linked notes with resolved paths and existence status.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.039506-06:00","updated_at":"2025-12-08T13:12:07.449371-06:00","closed_at":"2025-12-08T13:12:07.449371-06:00","dependencies":[{"issue_id":"petra-edq","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.040171-06:00","created_by":"daemon"}]}
{"id":"petra-efr","title":"MEDIUM: Add error handling for bridge fetch failures","description":"No error handling for fetch failures in `packages/cli/src/lib/bridge.ts:67-74`. request() doesn't catch network errors or validate HTTP status. Will throw unhandled exceptions.","design":"Wrap fetch in try-catch, handle network errors gracefully, validate HTTP status codes before parsing JSON response.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:11:04.586125-06:00","updated_at":"2025-12-08T14:11:04.586125-06:00","labels":["code-review","medium","stability"]}
{"id":"petra-eyq","title":"LOW: Add debug logging for file parse errors","description":"Silent failure on file parse error in `packages/cli/src/lib/notes.ts:191-193`. Catch block with empty comment \"Skip files that can't be parsed\".","design":"Log at debug level with filename and error details to help troubleshoot vault issues.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.686387-06:00","updated_at":"2025-12-08T14:11:33.686387-06:00","labels":["code-review","low","observability"]}
{"id":"petra-fhf","title":"HIGH: Fix template injection vulnerability","description":"Template injection vulnerability in `packages/plugin/src/routes/templates.ts:28-44`. processTemplate() uses regex replace without sanitization. Malicious templates could execute unintended code patterns.","design":"Escape/validate template variables. Consider using a proper templating engine like Handlebars or Mustache with safe defaults, or explicitly sanitize replacement values.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:10:39.823773-06:00","updated_at":"2025-12-08T14:10:39.823773-06:00","labels":["code-review","high","security"]}
{"id":"petra-g2w","title":"Add dependency vulnerability scanning to CI","description":"No automated dependency vulnerability scanning is configured. Should be part of CI/CD pipeline.","design":"Options:\n- npm audit in CI\n- Snyk integration\n- GitHub Dependabot\n\nAlso:\n- Pin exact versions instead of ranges for security-critical deps\n- Set up regular dependency update schedule (monthly)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-08T14:11:55.806495-06:00","updated_at":"2025-12-08T14:11:55.806495-06:00","labels":["code-review","devops","security"]}
{"id":"petra-hci","title":"Phase 4: Rich Operations","description":"Add bridge-only features: backlinks, outlinks, graph queries, template execution, and link-aware note moves.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-08T12:48:44.974462-06:00","updated_at":"2025-12-08T13:12:14.746464-06:00","closed_at":"2025-12-08T13:12:14.746464-06:00","dependencies":[{"issue_id":"petra-hci","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:46.631791-06:00","created_by":"daemon"}]}
{"id":"petra-hor","title":"Implement graph query endpoint","description":"Add POST /graph/query endpoint. Accept {from, depth, filter} params. Traverse Obsidian's link graph to specified depth. Return nodes and edges for visualization or analysis.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.287395-06:00","updated_at":"2025-12-08T13:12:07.659873-06:00","closed_at":"2025-12-08T13:12:07.659873-06:00","dependencies":[{"issue_id":"petra-hor","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.288159-06:00","created_by":"daemon"}]}
{"id":"petra-ix1","title":"Implement HTTP server in plugin","description":"Create HTTP server on localhost:27182 using Obsidian's requestUrl or native fetch. Implement /health endpoint. Handle CORS for local requests. Server starts on plugin load, stops on unload.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:04.719223-06:00","updated_at":"2025-12-08T13:01:04.92659-06:00","closed_at":"2025-12-08T13:01:04.92659-06:00","dependencies":[{"issue_id":"petra-ix1","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:04.720838-06:00","created_by":"daemon"},{"issue_id":"petra-ix1","depends_on_id":"petra-7ii","type":"blocks","created_at":"2025-12-08T12:49:46.720995-06:00","created_by":"daemon"}]}
{"id":"petra-jad","title":"Implement vault discovery","description":"Read ~/.obsidian/obsidian.json to find vaults, implement vault list/switch/info commands.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.102938-06:00","updated_at":"2025-12-08T12:37:04.492607-06:00","closed_at":"2025-12-08T12:37:04.492607-06:00","dependencies":[{"issue_id":"petra-jad","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.329086-06:00","created_by":"daemon"},{"issue_id":"petra-jad","depends_on_id":"petra-s3b","type":"blocks","created_at":"2025-12-08T12:20:30.807293-06:00","created_by":"daemon"}]}
{"id":"petra-jlz","title":"Create OpenAPI specification for HTTP API","description":"Document the HTTP API with OpenAPI/Swagger specification for better developer experience and client generation.","design":"Create docs/api/openapi.yaml documenting all endpoints:\n- /health\n- /notes CRUD operations\n- /search\n- /tags\n- /graph\n- /templates\n- /daily\n\nInclude request/response schemas, error codes, and authentication requirements.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-08T14:11:55.778493-06:00","updated_at":"2025-12-08T14:11:55.778493-06:00","labels":["code-review","documentation"]}
{"id":"petra-l4p","title":"MEDIUM: Fix trash file name collision risk","description":"Trash handling in `packages/cli/src/lib/notes.ts:127-147` uses basename() without uniqueness check. Same filename from different folders will collide in trash, potentially overwriting.","design":"Add timestamp or random suffix to trash filename, or preserve directory structure in trash folder.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:11:04.646404-06:00","updated_at":"2025-12-08T14:11:04.646404-06:00","labels":["code-review","medium","stability"]}
{"id":"petra-lc1","title":"Implement note search command","description":"Add `petra note search \u003cquery\u003e` for full-text content search across vault. Support --folder filter and --limit option. Return matching notes with context snippets.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:42:26.845871-06:00","updated_at":"2025-12-08T12:46:51.88325-06:00","closed_at":"2025-12-08T12:46:51.88325-06:00","dependencies":[{"issue_id":"petra-lc1","depends_on_id":"petra-r7u","type":"blocks","created_at":"2025-12-08T12:42:26.846525-06:00","created_by":"daemon"}]}
{"id":"petra-lfc","title":"Implement search and tag endpoints","description":"Add: POST /search (full-text via Obsidian search), GET /tags (all tags), GET /tags/:tag/notes (notes with tag). Leverage Obsidian's MetadataCache for efficient tag queries.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:05.183773-06:00","updated_at":"2025-12-08T13:04:44.271194-06:00","closed_at":"2025-12-08T13:04:44.271194-06:00","dependencies":[{"issue_id":"petra-lfc","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:05.184344-06:00","created_by":"daemon"}]}
{"id":"petra-na9","title":"Implement bridge CRUD endpoints","description":"Add REST endpoints: GET/POST /notes, GET/PUT/DELETE /notes/:path, POST /notes/:path/move, GET /vault. Use Obsidian API (app.vault) for file operations. Return ApiResponse format.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:04.954565-06:00","updated_at":"2025-12-08T13:01:05.134307-06:00","closed_at":"2025-12-08T13:01:05.134307-06:00","dependencies":[{"issue_id":"petra-na9","depends_on_id":"petra-azm","type":"blocks","created_at":"2025-12-08T12:49:04.955763-06:00","created_by":"daemon"},{"issue_id":"petra-na9","depends_on_id":"petra-93k","type":"blocks","created_at":"2025-12-08T12:49:46.894683-06:00","created_by":"daemon"}]}
{"id":"petra-nki","title":"HIGH: Add depth limit to recursive directory scan","description":"Recursive directory scan without depth limit in `packages/cli/src/lib/notes.ts:165-201`. scanDir() has no max depth - symlink loops or deep directories cause stack overflow.","design":"Add maxDepth parameter (default 20), detect symlink cycles, and handle gracefully when limit is reached.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:10:26.676727-06:00","updated_at":"2025-12-08T14:10:26.676727-06:00","labels":["code-review","high","stability"]}
{"id":"petra-nw2","title":"LOW: Handle double newlines when appending content","description":"Missing newline normalization in `packages/cli/src/lib/notes.ts:104`. Append option adds \"\\n\" but doesn't check if content already ends with newline. Could create double newlines.","design":"Check if existing content ends with newline before adding separator newline.","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-08T14:11:33.403442-06:00","updated_at":"2025-12-08T14:11:33.403442-06:00","labels":["code-quality","code-review","low"]}
{"id":"petra-p3v","title":"Implement daily notes commands","description":"Add `petra daily create` (create today's daily note), `petra daily open \u003cdate\u003e` (read a daily note), `petra daily list` (list recent daily notes). Read daily note format/folder from .obsidian/daily-notes.json.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:42:27.325027-06:00","updated_at":"2025-12-08T12:46:52.257922-06:00","closed_at":"2025-12-08T12:46:52.257922-06:00","dependencies":[{"issue_id":"petra-p3v","depends_on_id":"petra-r7u","type":"blocks","created_at":"2025-12-08T12:42:27.325701-06:00","created_by":"daemon"}]}
{"id":"petra-pea","title":"Implement note update command","description":"Update note content, support --append flag, preserve frontmatter.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.424131-06:00","updated_at":"2025-12-08T12:37:15.651784-06:00","closed_at":"2025-12-08T12:37:15.651784-06:00","dependencies":[{"issue_id":"petra-pea","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.559692-06:00","created_by":"daemon"},{"issue_id":"petra-pea","depends_on_id":"petra-zs9","type":"blocks","created_at":"2025-12-08T12:20:31.039498-06:00","created_by":"daemon"}]}
{"id":"petra-pm3","title":"LOW: Document localhost-only binding in server","description":"Hardcoded localhost binding in `packages/plugin/src/server.ts:77`. listen(DEFAULT_PORT, \"127.0.0.1\") - good for security but should be documented why not \"localhost\" or \"0.0.0.0\".","design":"Add code comment explaining security rationale for binding to 127.0.0.1 specifically.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.726949-06:00","updated_at":"2025-12-08T14:11:33.726949-06:00","labels":["code-review","documentation","low"]}
{"id":"petra-pz5","title":"Implement tag list command","description":"Add `petra tag list` to show all tags used in vault. Parse both frontmatter tags and inline #tags. Show count per tag.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:42:26.965908-06:00","updated_at":"2025-12-08T12:46:51.977409-06:00","closed_at":"2025-12-08T12:46:51.977409-06:00","dependencies":[{"issue_id":"petra-pz5","depends_on_id":"petra-r7u","type":"blocks","created_at":"2025-12-08T12:42:26.966744-06:00","created_by":"daemon"}]}
{"id":"petra-r7u","title":"Phase 2: File-Mode Search \u0026 Tags","description":"Add content search, tag management, note move, and daily notes commands to complete file-mode operations.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-08T12:42:13.575296-06:00","updated_at":"2025-12-08T12:46:52.35527-06:00","closed_at":"2025-12-08T12:46:52.35527-06:00"}
{"id":"petra-s3b","title":"Implement config system","description":"Config storage at ~/.petra/config.json, petra config set/get commands, environment variable overrides.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:07.992025-06:00","updated_at":"2025-12-08T12:37:04.452369-06:00","closed_at":"2025-12-08T12:37:04.452369-06:00","dependencies":[{"issue_id":"petra-s3b","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.255295-06:00","created_by":"daemon"},{"issue_id":"petra-s3b","depends_on_id":"petra-d30","type":"blocks","created_at":"2025-12-08T12:20:30.729865-06:00","created_by":"daemon"}]}
{"id":"petra-s53","title":"HIGH: Replace manual YAML parsing with proper library","description":"Manual YAML parsing in `packages/plugin/src/routes/notes.ts:8-36` is fragile. parseFrontmatter() doesn't handle edge cases: multiline values, escaped characters, nested objects. Will fail on complex frontmatter.","design":"Use js-yaml or gray-matter library which properly handles all YAML edge cases. gray-matter is already a standard choice for markdown frontmatter parsing.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:10:39.799564-06:00","updated_at":"2025-12-08T14:10:39.799564-06:00","labels":["code-review","high","stability"]}
{"id":"petra-sja","title":"Add note backlinks/outlinks CLI commands","description":"Add `petra note backlinks \u003cpath\u003e` and `petra note outlinks \u003cpath\u003e` commands. Require bridge mode (error with helpful message if unavailable). Display linked notes with context.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:49:26.164394-06:00","updated_at":"2025-12-08T13:12:07.55236-06:00","closed_at":"2025-12-08T13:12:07.55236-06:00","dependencies":[{"issue_id":"petra-sja","depends_on_id":"petra-hci","type":"blocks","created_at":"2025-12-08T12:49:26.165002-06:00","created_by":"daemon"}]}
{"id":"petra-ssp","title":"Implement note move command","description":"Add `petra note move \u003cfrom\u003e \u003cto\u003e` to rename/move notes. Warn user that links will not be updated (requires bridge mode). Handle directory creation.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:42:27.207942-06:00","updated_at":"2025-12-08T12:46:52.164228-06:00","closed_at":"2025-12-08T12:46:52.164228-06:00","dependencies":[{"issue_id":"petra-ssp","depends_on_id":"petra-r7u","type":"blocks","created_at":"2025-12-08T12:42:27.208618-06:00","created_by":"daemon"}]}
{"id":"petra-sug","title":"LOW: Fix frontmatter array serialization for round-trip consistency","description":"Inconsistent frontmatter serialization in `packages/plugin/src/routes/notes.ts:134-139`. Arrays serialized as \"[item1, item2]\" but parser expects spaces after commas. Could cause round-trip issues.","design":"Ensure consistent array format between serialization and parsing, or use YAML library that handles this properly.","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-08T14:11:33.525868-06:00","updated_at":"2025-12-08T14:11:33.525868-06:00","labels":["code-review","low","stability"]}
{"id":"petra-tqk","title":"LOW: Avoid global mutable state in output.ts","description":"Global mutable state in `packages/cli/src/lib/output.ts:7`. globalOptions is module-scoped mutable. Could cause issues in test environments.","design":"Consider passing options through context or using dependency injection pattern for better testability.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.796908-06:00","updated_at":"2025-12-08T14:11:33.796908-06:00","labels":["code-quality","code-review","low"]}
{"id":"petra-u3z","title":"CRITICAL: Fix remote path traversal in plugin notes API","description":"Path traversal vulnerability in `packages/plugin/src/routes/notes.ts:120-125`. normalizePath() doesn't prevent \"../\" sequences. Remote path traversal possible via HTTP API.","design":"Apply same safePath validation as CLI. Validate that resolved path starts with vault root before any file operations.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-08T14:10:07.380311-06:00","updated_at":"2025-12-08T15:14:07.446173-06:00","closed_at":"2025-12-08T15:14:07.446173-06:00","labels":["code-review","critical","security"]}
{"id":"petra-ut8","title":"Extract duplicated code to shared package","description":"Several functions are duplicated across CLI and plugin packages:\n- parseFrontmatter() - duplicated in 5 files\n- extractTags()/extractLinks() - duplicated logic\n- normalizePath() - duplicated in CLI and plugin","design":"Extract to @petra/shared package:\n1. Create shared/src/frontmatter.ts with parseFrontmatter\n2. Create shared/src/parsing.ts with extractTags, extractLinks\n3. Create shared/src/paths.ts with normalizePath, safePath\n4. Update CLI and plugin to import from shared","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-08T14:11:55.730531-06:00","updated_at":"2025-12-08T14:11:55.730531-06:00","labels":["code-quality","code-review","refactoring"]}
{"id":"petra-v7q","title":"Implement note list command","description":"List notes in vault, support --folder, --limit filters, parse frontmatter for metadata.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.646602-06:00","updated_at":"2025-12-08T12:37:15.712945-06:00","closed_at":"2025-12-08T12:37:15.712945-06:00","dependencies":[{"issue_id":"petra-v7q","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.715685-06:00","created_by":"daemon"},{"issue_id":"petra-v7q","depends_on_id":"petra-z6j","type":"blocks","created_at":"2025-12-08T12:20:31.203454-06:00","created_by":"daemon"}]}
{"id":"petra-vjs","title":"Create shared types package","description":"Define shared interfaces for notes, vaults, API responses, error codes, and constants.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:07.780753-06:00","updated_at":"2025-12-08T12:31:51.085956-06:00","closed_at":"2025-12-08T12:31:51.085956-06:00","dependencies":[{"issue_id":"petra-vjs","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.102979-06:00","created_by":"daemon"},{"issue_id":"petra-vjs","depends_on_id":"petra-13w","type":"blocks","created_at":"2025-12-08T12:20:30.570425-06:00","created_by":"daemon"}]}
{"id":"petra-vt6","title":"MEDIUM: Replace (vault.adapter as any) with proper type guards","description":"Type assertion bypasses type safety in `packages/plugin/src/main.ts:52`. `(vault.adapter as any).basePath` disables type checking. Could break if Obsidian API changes.","design":"Use proper type guards to check adapter type at runtime, or extend Obsidian types with declaration merging if basePath is a known property.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:04.761893-06:00","updated_at":"2025-12-08T14:11:04.761893-06:00","labels":["code-quality","code-review","medium"]}
{"id":"petra-wbj","title":"LOW: Implement daily notes config loading","description":"Incomplete daily config loading in `packages/plugin/src/routes/daily.ts:14-22`. getDailyConfig() has TODO comment about async but returns sync defaults. Should read actual config from Obsidian daily notes plugin.","design":"Read daily notes configuration from Obsidian's daily notes plugin settings for proper folder/format integration.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-08T14:11:33.865777-06:00","updated_at":"2025-12-08T14:11:33.865777-06:00","labels":["code-review","feature","low"]}
{"id":"petra-ym1","title":"HIGH: Add bounds to graph traversal to prevent infinite loops","description":"Potential infinite loop in `packages/plugin/src/routes/graph.ts:86-130`. BFS doesn't properly bound recursion. Large graphs could cause stack overflow or hang.","design":"Add depth limit, implement timeout, and properly track visited nodes with a Set. Consider adding configurable max nodes parameter.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-08T14:10:26.628991-06:00","updated_at":"2025-12-08T14:10:26.628991-06:00","labels":["code-review","high","stability"]}
{"id":"petra-z6j","title":"Implement note delete command","description":"Delete notes, optionally move to .trash instead of permanent delete.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.534827-06:00","updated_at":"2025-12-08T12:37:15.68189-06:00","closed_at":"2025-12-08T12:37:15.68189-06:00","dependencies":[{"issue_id":"petra-z6j","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.638623-06:00","created_by":"daemon"},{"issue_id":"petra-z6j","depends_on_id":"petra-pea","type":"blocks","created_at":"2025-12-08T12:20:31.128118-06:00","created_by":"daemon"}]}
{"id":"petra-zmt","title":"Add comprehensive test suite","description":"The codebase currently has 0% test coverage. Tests are essential before production use, especially for security-critical code paths.","design":"Required test coverage:\n- Unit tests for path normalization and traversal prevention\n- Security tests for token generation randomness\n- API integration tests for all endpoints\n- Edge case tests (empty files, large files, special characters in paths)\n- Performance tests for large vaults (1000+ notes)\n- Auth bypass attempt tests\n- Error handling coverage tests\n\nTarget coverage: 80%+ overall, 100% for security-critical code","acceptance_criteria":"- Unit tests exist for all core library functions\n- Integration tests for HTTP API endpoints\n- Security tests verify no auth bypass possible\n- CI runs tests on every PR","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-08T14:11:55.703197-06:00","updated_at":"2025-12-08T14:11:55.703197-06:00","labels":["blocking","code-review","testing"]}
{"id":"petra-zs9","title":"Implement note read command","description":"Read note content, parse YAML frontmatter, return content and metadata.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-08T12:20:08.317463-06:00","updated_at":"2025-12-08T12:37:15.623434-06:00","closed_at":"2025-12-08T12:37:15.623434-06:00","dependencies":[{"issue_id":"petra-zs9","depends_on_id":"petra-0n3","type":"parent-child","created_at":"2025-12-08T12:20:20.482029-06:00","created_by":"daemon"},{"issue_id":"petra-zs9","depends_on_id":"petra-0qc","type":"blocks","created_at":"2025-12-08T12:20:30.964385-06:00","created_by":"daemon"}]}
